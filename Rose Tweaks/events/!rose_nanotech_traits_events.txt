namespace = rose_nanotech_traits

country_event = {
	id = rose_nanotech_traits.0
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_tradition = tr_nanotech_finish
	}

	immediate = {
		modify_species = {
			species = owner_main_species
			add_trait = trait_rose_nanotech
		}
		change_dominant_species = {
			species = last_created_species
			change_all = yes
		}
	}
	
	after = {
		hidden_effect = {
			country_event = { id = rose_nanotech_traits.1 }
		}
	}
}

country_event = {
	id = rose_nanotech_traits.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_leader = {			
			if = {
				limit = {
					species = { has_trait = trait_rose_nanotech }
				}
				add_trait = {
					trait = leader_trait_rose_nanotech
					show_message = no
				}
			}
		}
	}
}

event = {
	id = rose_nanotech_traits.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_country = { 
			limit = {
				is_ai = no
			}
			country_event = { id = rose_nanotech_traits.1 }
		}
	}
}

event = {
	id = rose_nanotech_traits.3
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_country = { 
			limit = {
				is_ai = yes
			}
			country_event = { id = rose_nanotech_traits.1 }
		}
	}
}

# Colony Ship stragglers gate
planet_event = {
	id = rose_nanotech_traits.10
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = { has_tradition = tr_nanotech_finish }
	}

	immediate = {
		planet_event = { id = rose_nanotech_traits.11 days = 2 }
	}
}

# Colony Ship stragglers become nanotech
planet_event = {
	id = rose_nanotech_traits.11
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = { has_tradition = tr_nanotech_finish }
		any_owned_pop_group = {
			is_same_species = owner_main_species
			NOT = { has_trait = trait_rose_nanotech }
		}
	}

	immediate = {
		every_owned_pop_group = {
			limit = {
				is_same_species = owner_main_species
				NOT = { has_trait = trait_rose_nanotech }
			}
			modify_species = {
				species = this
				add_trait = trait_rose_nanotech
			}
		}
	}
}
